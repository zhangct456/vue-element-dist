webpackJsonp([13],{M0FV:function(e,n,r){e.exports=r("cttH")},cttH:function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var l={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("section",[r("h2",[e._v("文件大小优化")]),e._v(" "),r("blockquote",[r("p",[r("a",{attrs:{href:"https://segmentfault.com/a/1190000015489489"}},[e._v("https://segmentfault.com/a/1190000015489489")])])]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("使用webpack的"),r("code",{pre:!0},[e._v("DllPlugin")]),e._v("和"),r("code",{pre:!0},[e._v("DllReferencePlugin")])]),e._v(" "),r("h5",[e._v("DllPlugin")]),e._v(" "),r("p",[e._v("新建配置文件"),r("code",{pre:!0},[e._v("webpack.dll.conf.js")]),e._v("：")]),e._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[e._v("var path = require(\"path\");\nvar webpack = require(\"webpack\");\n\nfunction resolve (dir) {\n  return path.join(__dirname, '..', dir)\n}\n\nmodule.exports = {\n\tcontext: __dirname,\n  // 你想要打包的模块的数组\n  entry: {\n    vendor: ['vue', 'vuex', 'axios', 'vue-router', 'element-ui', 'xlsx'],\n    vendor2: ['echarts', 'jsplumb']\n  },\n  output: {\n    path: path.join(__dirname, 'src/dll/'), // 打包后文件输出的位置\n    filename: '[name].dll.js',\n    library: '[name]_library'\n    // vendor.dll.js中暴露出的全局变量名。\n    // 主要是给DllPlugin中的name使用，\n    // 故这里需要和webpack.DllPlugin中的`name: '[name]_library',`保持一致。\n  },\n  resolve: {\n    extensions: ['.js', '.vue', '.json'],\n    alias: {\n      'vue$': 'vue/dist/vue.esm.js',\n      '@': resolve('src'),\n    }\n  },\n  plugins: [\n    new webpack.DllPlugin({\n      path: path.join(__dirname, 'src/dll', '[name]-manifest.json'),\n      name: '[name]_library',\n    }),\n  ]\n};\n\n")])]),e._v(" "),r("p",[e._v("在"),r("code",{pre:!0},[e._v("package.json")]),e._v("文件中配置命令：")]),e._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[e._v('  "scripts": {\n  \t//...其它配置\n    "dll": "rimraf src/dll && webpack --mode production  --profile --inline --config webpack.dll.config.js"\n  }\n')])]),e._v(" "),r("p",[e._v("执行"),r("code",{pre:!0},[e._v("npm run dll")]),e._v("在"),r("code",{pre:!0},[e._v("src/dll")]),e._v("文件夹中生成了四个文件：")]),e._v(" "),r("ul",[r("li",[e._v("vendor.dll.js")]),e._v(" "),r("li",[e._v("vendor2.dll.js")]),e._v(" "),r("li",[e._v("vendor-manifest.json")]),e._v(" "),r("li",[e._v("vendor2-manifest.json")])]),e._v(" "),r("p",[e._v("其中js文件为打包后的文件，json文件是引导webpack引入到当前项目的文件。")]),e._v(" "),r("p",[e._v("在html中引入生成的js文件：")]),e._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[e._v("//webpack,prod.conf.js\n\n\n//引入插件\nconst AddAssetHtmlPlugin = require(\"add-asset-html-webpack-plugin\");\n\n//...\n\nplugins:[\n\tnew AddAssetHtmlPlugin([\n\t\t{ filepath: require.resolve('./src/dll/vendor.dll.js'), includeSourcemap: false },\n\t\t{ filepath: require.resolve('./src/dll/vendor2.dll.js'), includeSourcemap: false }\n\t])\n\t//...其它配置\n]\n\n//...\n")])]),e._v(" "),r("hr"),e._v(" "),r("h5",[e._v("DllReferencePlugin")]),e._v(" "),r("p",[e._v("配置生成的"),r("code",{pre:!0},[e._v("*-manifest.json")]),e._v("：")]),e._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[e._v('//webpack,prod.conf.js\n\n//...\n\nplugins:[\n\tnew webpack.DllReferencePlugin({\n        context: __dirname,\n        manifest: require("./src/dll/vendor-manifest.json")\n    }),\n    new webpack.DllReferencePlugin({\n        context: __dirname,\n        manifest: require("./src/dll/vendor2-manifest.json")\n    }),\n\t//...其它配置\n]\n\n//...\n')])]),e._v(" "),r("p",[e._v("当文件数量较多时可以创建一个数组遍历：")]),e._v(" "),r("pre",{pre:!0},[r("code",{attrs:{"v-pre":""}},[e._v("// 获取dll文件的manifest\nfunction getDllManifest () {\n    var plugins = []\n    Object.keys({\n        vendor: ['vue', 'vuex', 'axios', 'vue-router', 'element-ui', 'xlsx'],\n    \tvendor2: ['echarts', 'jsplumb']\n    }).forEach((name) => {\n        plugins.push(\n            new webpack.DllReferencePlugin({\n                context: __dirname, // 这里的context必须与DllPlugin中的context保持一致\n                manifest: path.resolve(__dirname, 'src/dll/[name]-manifest.json').replace(/\\[name\\]/gi, name)\n            })\n        )\n    })\n    return plugins\n}\n")])])])}]},t=r("C7Lr")(null,l,!1,null,null,null);n.default=t.exports}});
//# sourceMappingURL=13.2edf67223d854f0904ab.js.map